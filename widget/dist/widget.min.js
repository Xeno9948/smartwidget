!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.KiyohAIWidget=n():t.KiyohAIWidget=n()}(this,()=>(()=>{"use strict";var t={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function e(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return r(t,n);var e={}.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var o=0,a=function(){};return{s:a,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return c=t.done,t},e:function(t){u=!0,i=t},f:function(){try{c||null==e.return||e.return()}finally{if(u)throw i}}}}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=Array(n);e<n;e++)r[e]=t[e];return r}function o(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function c(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,l=Object.create(c.prototype);return a(l,"_invoke",function(e,r,o){var a,i,c,s=0,l=o||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return a=n,i=0,c=t,p.n=e,u}};function f(e,r){for(i=e,c=r,n=0;!d&&s&&!o&&n<l.length;n++){var o,a=l[n],f=p.p,v=a[2];e>3?(o=v===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(i=0,p.v=r,p.n=a[1]):f<v&&(o=e<3||a[0]>r||r>v)&&(a[4]=e,a[5]=r,p.n=v,i=0))}if(o||e>1)return u;throw d=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,v),i=l,c=v;(n=i<2?t:c)||!d;){a||(i?i<3?(i>1&&(p.n=-1),f(i,c)):p.n=c:p.v=c);try{if(s=2,a){if(i||(o="next"),n=a[o]){if(!(n=n.call(a,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,i<2&&(i=0)}else 1===i&&(n=a.return)&&n.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=t}else if((n=(d=p.n<0)?c:e.call(r,p))!==u)break}catch(n){a=t,i=1,c=n}finally{s=1}}return{value:n,done:d}}}(e,o,i),!0),l}var u={};function s(){}function l(){}function d(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(a(n={},r,function(){return this}),n),f=d.prototype=s.prototype=Object.create(p);function v(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,a(t,i,"GeneratorFunction")),t.prototype=Object.create(f),t}return l.prototype=d,a(f,"constructor",d),a(d,"constructor",l),l.displayName="GeneratorFunction",a(d,i,"GeneratorFunction"),a(f),a(f,i,"Generator"),a(f,r,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:v}})()}function a(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,n,e,r){function i(n,e){a(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},a(t,n,e,r)}function i(t,n,e,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function c(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var a=t.apply(n,e);function c(t){i(a,r,o,c,u,"next",t)}function u(t){i(a,r,o,c,u,"throw",t)}c(void 0)})}}function u(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,e||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==n(e)?e:e+""}const l=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=null,r=[{key:"detect",value:(d=c(o().m(function t(){var n,e,r,a;return o().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,this.detectGTIN();case 1:if(!(n=t.v)){t.n=2;break}return t.a(2,{type:"gtin",value:n});case 2:return t.n=3,this.detectProductName();case 3:if(!(e=t.v)){t.n=4;break}return t.a(2,{type:"name",value:e});case 4:return t.n=5,this.detectSKU();case 5:if(!(r=t.v)){t.n=6;break}return t.a(2,{type:"sku",value:r});case 6:return t.n=7,this.detectProductId();case 7:if(!(a=t.v)){t.n=8;break}return t.a(2,{type:"id",value:a});case 8:return t.a(2,null)}},t,this)})),function(){return d.apply(this,arguments)})},{key:"detectGTIN",value:(l=c(o().m(function t(){var n,e,r,a;return o().w(function(t){for(;;)switch(t.n){case 0:if(!(n=this.extractFromSchema())){t.n=1;break}return t.a(2,n);case 1:if(!(e=this.extractFromDataAttributes())){t.n=2;break}return t.a(2,e);case 2:if(!(r=this.extractFromMetaTags())){t.n=3;break}return t.a(2,r);case 3:if(!(a=this.extractFromJsonLd())){t.n=4;break}return t.a(2,a);case 4:return t.a(2,null)}},t,this)})),function(){return l.apply(this,arguments)})},{key:"extractFromSchema",value:function(){for(var t=0,n=['[itemprop="gtin"]','[itemprop="gtin13"]','[itemprop="gtin12"]','[itemprop="gtin8"]','[itemprop="ean"]'];t<n.length;t++){var e=n[t],r=document.querySelector(e);if(r){var o,a=r.content||(null===(o=r.textContent)||void 0===o?void 0:o.trim());if(this.isValidGTIN(a))return a}}return null}},{key:"extractFromDataAttributes",value:function(){for(var t=0,n=["data-gtin","data-ean","data-upc","data-product-code"];t<n.length;t++){var e=n[t],r=document.querySelector("[".concat(e,"]"));if(r){var o=r.getAttribute(e);if(this.isValidGTIN(o))return o}}return null}},{key:"extractFromMetaTags",value:function(){for(var t=0,n=["gtin","gtin13","product:gtin","product:ean"];t<n.length;t++){var e=n[t],r=document.querySelector('meta[property="'.concat(e,'"], meta[name="').concat(e,'"]'));if(r){var o=r.content;if(this.isValidGTIN(o))return o}}return null}},{key:"extractFromJsonLd",value:function(){var t,n=e(document.querySelectorAll('script[type="application/ld+json"]'));try{for(n.s();!(t=n.n()).done;){var r=t.value;try{var o=JSON.parse(r.textContent),a=o.gtin||o.gtin13||o.gtin12||o.gtin8||o.ean;if(this.isValidGTIN(a))return a;if("Product"===o["@type"]||o.product){var i=o.product||o,c=i.gtin||i.gtin13||i.ean;if(this.isValidGTIN(c))return c}}catch(t){}}}catch(t){n.e(t)}finally{n.f()}return null}},{key:"isValidGTIN",value:function(t){if(!t)return!1;var n=String(t).replace(/\D/g,"");return n.length>=8&&n.length<=14}},{key:"detectProductName",value:(s=c(o().m(function t(){var n,e,r,a,i,c;return o().w(function(t){for(;;)switch(t.n){case 0:if(!((a=null===(n=document.querySelector("h1"))||void 0===n||null===(n=n.textContent)||void 0===n?void 0:n.trim())&&a.length>3&&a.length<200)){t.n=1;break}return t.a(2,a);case 1:if(!((i=null===(e=document.querySelector('meta[property="og:title"]'))||void 0===e?void 0:e.content)&&i.length>3)){t.n=2;break}return t.a(2,i);case 2:if(!((c=null===(r=document.querySelector('[itemprop="name"]'))||void 0===r||null===(r=r.textContent)||void 0===r?void 0:r.trim())&&c.length>3)){t.n=3;break}return t.a(2,c);case 3:return t.a(2,null)}},t)})),function(){return s.apply(this,arguments)})},{key:"detectSKU",value:(i=c(o().m(function t(){var n,e,r,a,i,c;return o().w(function(t){for(;;)switch(t.n){case 0:if(!(n=document.querySelector("[data-sku], [data-product-sku]"))){t.n=1;break}if(!((r=n.dataset.sku||n.dataset.productSku||(null===(e=n.textContent)||void 0===e?void 0:e.trim()))&&r.length>0)){t.n=1;break}return t.a(2,r);case 1:if(!(a=document.querySelector('[itemprop="sku"]'))){t.n=2;break}if(!(c=a.content||(null===(i=a.textContent)||void 0===i?void 0:i.trim()))){t.n=2;break}return t.a(2,c);case 2:return t.a(2,null)}},t)})),function(){return i.apply(this,arguments)})},{key:"detectProductId",value:(a=c(o().m(function t(){var n,e,r,a,i;return o().w(function(t){for(;;)switch(t.n){case 0:n=window.location.pathname,e=0,r=[/\/product\/([a-zA-Z0-9-_]+)/,/\/p\/([a-zA-Z0-9-_]+)/,/\/item\/([a-zA-Z0-9-_]+)/,/\/([0-9]{4,})/];case 1:if(!(e<r.length)){t.n=3;break}if(a=r[e],!(i=n.match(a))||!i[1]){t.n=2;break}return t.a(2,i[1]);case 2:e++,t.n=1;break;case 3:return t.a(2,null)}},t)})),function(){return a.apply(this,arguments)})}],n&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,r,a,i,s,l,d}();function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function p(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function f(t){var n=function(t,n){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==d(n)?n:n+""}const v=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.productInfo={name:null,specs:{},description:null,attributes:{},images:[]}},(n=[{key:"scrape",value:function(){return this.extractProductName(),this.extractDescription(),this.extractSpecifications(),this.extractAttributes(),this.extractImages(),this.productInfo}},{key:"extractProductName",value:function(){for(var t=0,n=[function(){var t;return null===(t=document.querySelector("h1"))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()},function(){var t;return null===(t=document.querySelector('meta[property="og:title"]'))||void 0===t?void 0:t.content},function(){var t;return null===(t=document.querySelector('meta[name="product_name"]'))||void 0===t?void 0:t.content},function(){var t,n=document.querySelector('[itemtype*="schema.org/Product"]');return null==n||null===(t=n.querySelector('[itemprop="name"]'))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()},function(){return document.title.split("|")[0].split("-")[0].trim()}];t<n.length;t++){var e=n[t];try{var r=e();if(r&&r.length>0&&r.length<200)return void(this.productInfo.name=r)}catch(t){}}}},{key:"extractDescription",value:function(){for(var t=0,n=[function(){var t;return null===(t=document.querySelector('meta[name="description"]'))||void 0===t?void 0:t.content},function(){var t;return null===(t=document.querySelector('meta[property="og:description"]'))||void 0===t?void 0:t.content},function(){var t;return null===(t=document.querySelector(".product-description"))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()},function(){var t;return null===(t=document.querySelector("#description"))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()},function(){var t;return null===(t=document.querySelector('[class*="description"]'))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()},function(){var t;return null===(t=document.querySelector('[itemprop="description"]'))||void 0===t||null===(t=t.textContent)||void 0===t?void 0:t.trim()}];t<n.length;t++){var e=n[t];try{var r=e();if(r&&r.length>10&&r.length<1e3)return void(this.productInfo.description=r)}catch(t){}}}},{key:"extractSpecifications",value:function(){var t=this,n={};document.querySelectorAll('table[class*="spec"], table[class*="specification"], table.features, table.details').forEach(function(e){e.querySelectorAll("tr").forEach(function(e){var r=e.querySelectorAll("th, td");if(r.length>=2){var o=r[0].textContent.trim(),a=r[1].textContent.trim();o&&a&&(n[t.normalizeKey(o)]=a)}})}),document.querySelectorAll('dl[class*="spec"], dl[class*="attribute"], dl.product-info').forEach(function(e){var r=e.querySelectorAll("dt"),o=e.querySelectorAll("dd");r.forEach(function(e,r){if(o[r]){var a=e.textContent.trim(),i=o[r].textContent.trim();a&&i&&(n[t.normalizeKey(a)]=i)}})}),document.querySelectorAll("[data-spec], [itemprop]").forEach(function(e){var r,o=e.dataset.spec||e.getAttribute("itemprop"),a=(null===(r=e.textContent)||void 0===r?void 0:r.trim())||e.content;o&&a&&(n[t.normalizeKey(o)]=a)}),Object.keys(n).length>0&&(this.productInfo.specs=n)}},{key:"extractAttributes",value:function(){var t,n={},e=document.querySelector('[data-color], .color-name, [itemprop="color"]');e&&(n.color=(null===(t=e.textContent)||void 0===t?void 0:t.trim())||e.dataset.color);var r,o=document.querySelector('[data-size], .size-value, [itemprop="size"]');o&&(n.size=(null===(r=o.textContent)||void 0===r?void 0:r.trim())||o.dataset.size);var a,i=document.querySelector('[data-material], [itemprop="material"]');i&&(n.material=(null===(a=i.textContent)||void 0===a?void 0:a.trim())||i.dataset.material);var c,u=document.querySelector('[itemprop="brand"]');u&&(n.brand=(null===(c=u.textContent)||void 0===c?void 0:c.trim())||u.content),Object.keys(n).length>0&&(this.productInfo.attributes=n)}},{key:"extractImages",value:function(){var t,n=[],e=null===(t=document.querySelector('meta[property="og:image"]'))||void 0===t?void 0:t.content;e&&n.push(e),document.querySelectorAll('.product-image img, [class*="product-img"] img, [itemprop="image"]').forEach(function(t){var e=t.src||t.dataset.src;e&&!n.includes(e)&&n.push(e)}),this.productInfo.images=n.slice(0,3)}},{key:"normalizeKey",value:function(t){return t.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"_")}}])&&p(t.prototype,n),e&&p(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e}();function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function a(e,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return y(s,"_invoke",function(e,r,o){var a,c,u,s=0,l=o||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return a=n,c=0,u=t,p.n=e,i}};function f(e,r){for(c=e,u=r,n=0;!d&&s&&!o&&n<l.length;n++){var o,a=l[n],f=p.p,v=a[2];e>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(c=0,p.v=r,p.n=a[1]):f<v&&(o=e<3||a[0]>r||r>v)&&(a[4]=e,a[5]=r,p.n=v,c=0))}if(o||e>1)return i;throw d=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,v),c=l,u=v;(n=c<2?t:u)||!d;){a||(c?c<3?(c>1&&(p.n=-1),f(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),n=a[o]){if(!(n=n.call(a,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((n=(d=p.n<0)?u:e.call(r,p))!==i)break}catch(n){a=t,c=1,u=n}finally{s=1}}return{value:n,done:d}}}(e,o,a),!0),s}var i={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(y(n={},r,function(){return this}),n),d=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,y(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=s,y(d,"constructor",s),y(s,"constructor",u),u.displayName="GeneratorFunction",y(s,o,"GeneratorFunction"),y(d),y(d,o,"Generator"),y(d,r,function(){return this}),y(d,"toString",function(){return"[object Generator]"}),(b=function(){return{w:a,m:p}})()}function y(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}y=function(t,n,e,r){function a(n,e){y(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(a("next",0),a("throw",1),a("return",2))},y(t,n,e,r)}function h(t,n,e,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function g(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var a=t.apply(n,e);function i(t){h(a,r,o,i,c,"next",t)}function c(t){h(a,r,o,i,c,"throw",t)}i(void 0)})}}function w(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,x(r.key),r)}}function x(t){var n=function(t,n){if("object"!=m(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==m(n)?n:n+""}const k=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=n||"http://localhost:3000/api/v1"},n=[{key:"askQuestion",value:(a=g(b().m(function t(n,e,r){var o,a,i,c=arguments;return b().w(function(t){for(;;)switch(t.n){case 0:return o=c.length>3&&void 0!==c[3]?c[3]:"nl",t.n=1,fetch("".concat(this.baseUrl,"/qa"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locationId:n,question:e,language:o,productCode:(null==r?void 0:r.productCode)||r,productIdentifier:null==r?void 0:r.productIdentifier,productContext:null==r?void 0:r.productContext})});case 1:if((a=t.v).ok){t.n=3;break}return t.n=2,a.json().catch(function(){return{error:"Network error"}});case 2:throw i=t.v,new Error(i.error||"HTTP ".concat(a.status));case 3:return t.n=4,a.json();case 4:return t.a(2,t.v)}},t,this)})),function(t,n,e){return a.apply(this,arguments)})},{key:"getPopularQuestions",value:(o=g(b().m(function t(n){var e,r,o=arguments;return b().w(function(t){for(;;)switch(t.n){case 0:return e=o.length>1&&void 0!==o[1]?o[1]:5,t.n=1,fetch("".concat(this.baseUrl,"/qa/popular/").concat(n,"?limit=").concat(e));case 1:if((r=t.v).ok){t.n=2;break}throw new Error("HTTP ".concat(r.status));case 2:return t.n=3,r.json();case 3:return t.a(2,t.v)}},t,this)})),function(t){return o.apply(this,arguments)})},{key:"getQAHistory",value:(r=g(b().m(function t(n){var e,r,o=arguments;return b().w(function(t){for(;;)switch(t.n){case 0:return e=o.length>1&&void 0!==o[1]?o[1]:10,t.n=1,fetch("".concat(this.baseUrl,"/qa/history/").concat(n,"?limit=").concat(e));case 1:if((r=t.v).ok){t.n=2;break}throw new Error("HTTP ".concat(r.status));case 2:return t.n=3,r.json();case 3:return t.a(2,t.v)}},t,this)})),function(t){return r.apply(this,arguments)})}],n&&w(t.prototype,n),e&&w(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,r,o,a}();function S(t){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},S(t)}function j(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,r)}return e}function O(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?j(Object(e),!0).forEach(function(n){P(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):j(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function P(t,n,e){return(n=z(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function q(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function a(e,r,o,a){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return C(s,"_invoke",function(e,r,o){var a,c,u,s=0,l=o||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return a=n,c=0,u=t,p.n=e,i}};function f(e,r){for(c=e,u=r,n=0;!d&&s&&!o&&n<l.length;n++){var o,a=l[n],f=p.p,v=a[2];e>3?(o=v===r)&&(u=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=t):a[0]<=f&&((o=e<2&&f<a[1])?(c=0,p.v=r,p.n=a[1]):f<v&&(o=e<3||a[0]>r||r>v)&&(a[4]=e,a[5]=r,p.n=v,c=0))}if(o||e>1)return i;throw d=!0,r}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&f(l,v),c=l,u=v;(n=c<2?t:u)||!d;){a||(c?c<3?(c>1&&(p.n=-1),f(c,u)):p.n=u:p.v=u);try{if(s=2,a){if(c||(o="next"),n=a[o]){if(!(n=n.call(a,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=a.return)&&n.call(a),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=t}else if((n=(d=p.n<0)?u:e.call(r,p))!==i)break}catch(n){a=t,c=1,u=n}finally{s=1}}return{value:n,done:d}}}(e,o,a),!0),s}var i={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var l=[][r]?n(n([][r]())):(C(n={},r,function(){return this}),n),d=s.prototype=c.prototype=Object.create(l);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,C(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return u.prototype=s,C(d,"constructor",s),C(s,"constructor",u),u.displayName="GeneratorFunction",C(s,o,"GeneratorFunction"),C(d),C(d,o,"Generator"),C(d,r,function(){return this}),C(d,"toString",function(){return"[object Generator]"}),(q=function(){return{w:a,m:p}})()}function C(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}C=function(t,n,e,r){function a(n,e){C(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(a("next",0),a("throw",1),a("return",2))},C(t,n,e,r)}function I(t,n,e,r,o,a,i){try{var c=t[a](i),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function T(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var a=t.apply(n,e);function i(t){I(a,r,o,i,c,"next",t)}function c(t){I(a,r,o,i,c,"throw",t)}i(void 0)})}}function E(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z(r.key),r)}}function z(t){var n=function(t,n){if("object"!=S(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==S(n)?n:n+""}function A(t,n,e){return n=F(n),function(t,n){if(n&&("object"==S(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,G()?Reflect.construct(n,e||[],F(t).constructor):n.apply(t,e))}function _(t){var n="function"==typeof Map?new Map:void 0;return _=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(t,n,e){if(G())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(t.bind.apply(t,r));return e&&N(o,e.prototype),o}(t,arguments,F(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),N(e,t)},_(t)}function G(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(G=function(){return!!t})()}function N(t,n){return N=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},N(t,n)}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}var R=function(t){function n(){var t;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(t=A(this,n)).attachShadow({mode:"open"}),t.state={locationId:null,productCode:null,productIdentifier:null,productContext:null,autoDetect:!0,language:"nl",primaryColor:"#00a0dc",showProductInfo:!0,apiBaseUrl:null,loading:!1,error:null,answer:null,popularQuestions:[]},t.apiClient=null,t}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&N(t,n)}(n,t),e=n,r=[{key:"attributeChangedCallback",value:function(t,n,e){var r={"data-location-id":"locationId","data-product-code":"productCode","data-auto-detect":"autoDetect","data-language":"language","data-primary-color":"primaryColor","data-show-product-info":"showProductInfo","data-api-base-url":"apiBaseUrl"}[t];r&&(this.state[r]="autoDetect"===r||"showProductInfo"===r?"false"!==e:e)}},{key:"connectedCallback",value:(u=T(q().m(function t(){return q().w(function(t){for(;;)switch(t.n){case 0:return this.render(),t.n=1,this.initialize();case 1:return t.a(2)}},t,this)})),function(){return u.apply(this,arguments)})},{key:"initialize",value:(c=T(q().m(function t(){var n,e;return q().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,this.state.locationId){t.n=1;break}throw new Error("data-location-id is required");case 1:if(this.apiClient=new k(this.state.apiBaseUrl||"https://your-api-domain.com/api/v1"),n=new v,this.state.productContext=n.scrape(),!this.state.autoDetect||this.state.productCode){t.n=3;break}return t.n=2,l.detect();case 2:this.state.productIdentifier=t.v,this.state.productIdentifier&&"gtin"===this.state.productIdentifier.type&&(this.state.productCode=this.state.productIdentifier.value);case 3:return t.n=4,this.loadPopularQuestions();case 4:this.render(),t.n=6;break;case 5:t.p=5,e=t.v,this.setState({error:e.message});case 6:return t.a(2)}},t,this,[[0,5]])})),function(){return c.apply(this,arguments)})},{key:"loadPopularQuestions",value:(i=T(q().m(function t(){var n;return q().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,this.apiClient.getPopularQuestions(this.state.locationId,5);case 1:(n=t.v).success&&n.data.questions.length>0&&this.setState({popularQuestions:n.data.questions.slice(0,5)}),t.n=3;break;case 2:t.p=2,t.v;case 3:return t.a(2)}},t,this,[[0,2]])})),function(){return i.apply(this,arguments)})},{key:"setState",value:function(t){this.state=O(O({},this.state),t),this.render()}},{key:"handleSubmit",value:(a=T(q().m(function t(n){var e,r,o,a,i=this;return q().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.preventDefault(),e=this.shadowRoot.querySelector(".question-input"),r=e.value.trim()){t.n=1;break}return t.a(2);case 1:return this.setState({loading:!0,error:null,answer:null}),t.p=2,t.n=3,this.apiClient.askQuestion(this.state.locationId,r,{productCode:this.state.productCode,productIdentifier:this.state.productIdentifier,productContext:this.state.productContext},this.state.language);case 3:(o=t.v).success&&(this.setState({loading:!1,answer:o.data}),setTimeout(function(){var t=i.shadowRoot.querySelector(".answer-section");t&&t.scrollIntoView({behavior:"smooth",block:"nearest"})},100)),t.n=5;break;case 4:t.p=4,a=t.v,this.setState({loading:!1,error:a.message||"Failed to get answer. Please try again."});case 5:return t.p=5,e.value="",t.f(5);case 6:return t.a(2)}},t,this,[[2,4,5,6]])})),function(t){return a.apply(this,arguments)})},{key:"handlePopularQuestionClick",value:function(t){var n=this.shadowRoot.querySelector(".question-input");n.value=t,n.focus(),this.shadowRoot.querySelector("form").dispatchEvent(new Event("submit"))}},{key:"handleInputChange",value:function(t){var n=this.shadowRoot.querySelector(".char-counter");n&&(n.textContent="".concat(t.target.value.length,"/500"))}},{key:"renderStars",value:function(t){var n=Math.floor(t/2),e=t/2%1>=.5,r="‚òÖ".repeat(n);return e&&(r+="‚òÜ"),r.padEnd(5,"‚òÜ")}},{key:"render",value:function(){var t=this,n=this.state,e=n.answer,r=n.loading,o=n.error,a=n.popularQuestions;this.shadowRoot.innerHTML="\n      <style>".concat("\n  :host {\n    --primary-color: var(--kiyoh-primary, #00a0dc);\n    --primary-rgb: 0, 160, 220;\n    --glass-bg: rgba(255, 255, 255, 0.7);\n    --glass-border: rgba(255, 255, 255, 0.3);\n    --glass-shadow: rgba(0, 0, 0, 0.1);\n    --text-primary: #1a1a1a;\n    --text-secondary: #666;\n    --border-radius: 20px;\n    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n\n    display: block;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;\n    font-size: 16px;\n    line-height: 1.5;\n    color: var(--text-primary);\n  }\n\n  * {\n    box-sizing: border-box;\n    margin: 0;\n    padding: 0;\n  }\n\n  .widget-container {\n    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%);\n    backdrop-filter: blur(20px) saturate(180%);\n    -webkit-backdrop-filter: blur(20px) saturate(180%);\n    border: 1px solid var(--glass-border);\n    border-radius: var(--border-radius);\n    padding: 2rem;\n    max-width: 800px;\n    margin: 0 auto;\n    box-shadow:\n      0 8px 32px var(--glass-shadow),\n      0 2px 8px rgba(0, 0, 0, 0.05),\n      inset 0 1px 0 rgba(255, 255, 255, 0.8);\n    position: relative;\n    overflow: hidden;\n  }\n\n  .widget-container::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 2px;\n    background: linear-gradient(90deg,\n      transparent,\n      var(--primary-color),\n      transparent\n    );\n    opacity: 0.5;\n  }\n\n  .product-header {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n    padding: 1.5rem;\n    background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.05) 0%, rgba(var(--primary-rgb), 0.02) 100%);\n    border-radius: 16px;\n    border: 1px solid rgba(var(--primary-rgb), 0.1);\n    margin-bottom: 2rem;\n    transition: var(--transition);\n  }\n\n  .product-header:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 8px 24px rgba(var(--primary-rgb), 0.15);\n  }\n\n  .product-image {\n    width: 80px;\n    height: 80px;\n    border-radius: 12px;\n    object-fit: cover;\n    border: 2px solid rgba(255, 255, 255, 0.8);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  }\n\n  .product-info {\n    flex: 1;\n  }\n\n  .product-name {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 0.5rem;\n  }\n\n  .product-rating {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n  }\n\n  .stars {\n    color: #fbbf24;\n    font-size: 1.1rem;\n  }\n\n  .question-input-container {\n    margin-bottom: 2rem;\n  }\n\n  .input-label {\n    display: block;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 0.75rem;\n    font-size: 1rem;\n  }\n\n  .question-input {\n    width: 100%;\n    padding: 1rem 1.25rem;\n    border: 2px solid transparent;\n    border-radius: 14px;\n    background: rgba(255, 255, 255, 0.9);\n    backdrop-filter: blur(10px);\n    font-size: 1rem;\n    font-family: inherit;\n    color: var(--text-primary);\n    transition: var(--transition);\n    resize: vertical;\n    min-height: 100px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n  }\n\n  .question-input:focus {\n    outline: none;\n    border-color: var(--primary-color);\n    box-shadow:\n      0 4px 16px rgba(var(--primary-rgb), 0.2),\n      0 0 0 4px rgba(var(--primary-rgb), 0.1);\n    background: rgba(255, 255, 255, 1);\n  }\n\n  .question-input::placeholder {\n    color: var(--text-secondary);\n    opacity: 0.6;\n  }\n\n  .char-counter {\n    text-align: right;\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    margin-top: 0.5rem;\n  }\n\n  .ask-button {\n    width: 100%;\n    padding: 1rem 2rem;\n    border: none;\n    border-radius: 14px;\n    background: linear-gradient(135deg, var(--primary-color) 0%, rgba(var(--primary-rgb), 0.8) 100%);\n    color: white;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: var(--transition);\n    box-shadow:\n      0 4px 16px rgba(var(--primary-rgb), 0.3),\n      inset 0 1px 0 rgba(255, 255, 255, 0.2);\n    position: relative;\n    overflow: hidden;\n  }\n\n  .ask-button::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.3);\n    transform: translate(-50%, -50%);\n    transition: width 0.6s, height 0.6s;\n  }\n\n  .ask-button:hover::before {\n    width: 300px;\n    height: 300px;\n  }\n\n  .ask-button:hover {\n    transform: translateY(-2px);\n    box-shadow:\n      0 8px 24px rgba(var(--primary-rgb), 0.4),\n      inset 0 1px 0 rgba(255, 255, 255, 0.3);\n  }\n\n  .ask-button:active {\n    transform: translateY(0);\n  }\n\n  .ask-button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n\n  .loading {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 0.75rem;\n    padding: 2rem;\n  }\n\n  .spinner {\n    width: 40px;\n    height: 40px;\n    border: 3px solid rgba(var(--primary-rgb), 0.2);\n    border-top-color: var(--primary-color);\n    border-radius: 50%;\n    animation: spin 0.8s linear infinite;\n  }\n\n  @keyframes spin {\n    to { transform: rotate(360deg); }\n  }\n\n  .answer-container {\n    background: linear-gradient(135deg, rgba(var(--primary-rgb), 0.03) 0%, rgba(255, 255, 255, 0.5) 100%);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(var(--primary-rgb), 0.15);\n    border-radius: 16px;\n    padding: 1.5rem;\n    margin-bottom: 1.5rem;\n    animation: slideIn 0.5s ease-out;\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);\n  }\n\n  @keyframes slideIn {\n    from {\n      opacity: 0;\n      transform: translateY(20px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n\n  .answer-header {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    margin-bottom: 1rem;\n  }\n\n  .ai-icon {\n    width: 32px;\n    height: 32px;\n    background: linear-gradient(135deg, var(--primary-color) 0%, rgba(var(--primary-rgb), 0.7) 100%);\n    border-radius: 8px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    color: white;\n    font-weight: bold;\n    box-shadow: 0 2px 8px rgba(var(--primary-rgb), 0.3);\n  }\n\n  .answer-title {\n    font-weight: 600;\n    color: var(--text-primary);\n    font-size: 1rem;\n  }\n\n  .confidence-badge {\n    margin-left: auto;\n    padding: 0.25rem 0.75rem;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .confidence-high {\n    background: rgba(16, 185, 129, 0.15);\n    color: #059669;\n    border: 1px solid rgba(16, 185, 129, 0.3);\n  }\n\n  .confidence-medium {\n    background: rgba(251, 191, 36, 0.15);\n    color: #d97706;\n    border: 1px solid rgba(251, 191, 36, 0.3);\n  }\n\n  .confidence-low {\n    background: rgba(239, 68, 68, 0.15);\n    color: #dc2626;\n    border: 1px solid rgba(239, 68, 68, 0.3);\n  }\n\n  .answer-text {\n    font-size: 1rem;\n    line-height: 1.7;\n    color: var(--text-primary);\n  }\n\n  .review-snippets {\n    margin-top: 2rem;\n  }\n\n  .snippets-title {\n    font-size: 0.9rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 1rem;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n\n  .review-snippet {\n    background: rgba(255, 255, 255, 0.8);\n    backdrop-filter: blur(10px);\n    border: 1px solid rgba(0, 0, 0, 0.06);\n    border-radius: 12px;\n    padding: 1rem;\n    margin-bottom: 0.75rem;\n    transition: var(--transition);\n  }\n\n  .review-snippet:hover {\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);\n  }\n\n  .review-rating {\n    color: #fbbf24;\n    font-weight: 600;\n    margin-bottom: 0.5rem;\n  }\n\n  .review-text {\n    font-size: 0.95rem;\n    color: var(--text-primary);\n    line-height: 1.6;\n    margin-bottom: 0.5rem;\n  }\n\n  .review-author {\n    font-size: 0.85rem;\n    color: var(--text-secondary);\n    font-style: italic;\n  }\n\n  .popular-questions {\n    margin-top: 2rem;\n  }\n\n  .popular-title {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n    margin-bottom: 1rem;\n  }\n\n  .question-buttons {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.75rem;\n  }\n\n  .question-button {\n    padding: 0.6rem 1.2rem;\n    border: 1px solid rgba(var(--primary-rgb), 0.2);\n    border-radius: 24px;\n    background: rgba(255, 255, 255, 0.8);\n    backdrop-filter: blur(10px);\n    color: var(--text-primary);\n    font-size: 0.9rem;\n    cursor: pointer;\n    transition: var(--transition);\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);\n  }\n\n  .question-button:hover {\n    background: var(--primary-color);\n    color: white;\n    border-color: var(--primary-color);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.3);\n  }\n\n  .error-message {\n    background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(239, 68, 68, 0.05) 100%);\n    border: 1px solid rgba(239, 68, 68, 0.3);\n    border-radius: 12px;\n    padding: 1.25rem;\n    color: #dc2626;\n    margin-bottom: 1.5rem;\n    animation: shake 0.5s;\n  }\n\n  @keyframes shake {\n    0%, 100% { transform: translateX(0); }\n    25% { transform: translateX(-10px); }\n    75% { transform: translateX(10px); }\n  }\n\n  .hidden {\n    display: none;\n  }\n\n  @media (max-width: 768px) {\n    .widget-container {\n      padding: 1.5rem;\n      border-radius: 16px;\n    }\n\n    .product-header {\n      flex-direction: column;\n      text-align: center;\n    }\n\n    .product-image {\n      width: 100px;\n      height: 100px;\n    }\n\n    .question-input {\n      font-size: 16px; /* Prevent zoom on iOS */\n    }\n  }\n",'</style>\n      <div class="widget-container">\n        ').concat(o?'\n          <div class="error-message">\n            ‚ö†Ô∏è '.concat(o,"\n          </div>\n        "):"","\n\n        ").concat(e&&e.product&&this.state.showProductInfo?'\n          <div class="product-header">\n            '.concat(e.product.imageUrl?'\n              <img src="'.concat(e.product.imageUrl,'" alt="').concat(e.product.name,'" class="product-image">\n            '):"",'\n            <div class="product-info">\n              <div class="product-name">').concat(e.product.name,'</div>\n              <div class="product-rating">\n                <span class="stars">').concat(this.renderStars(e.product.rating),"</span>\n                <span>").concat(e.product.rating,"/10</span>\n                <span>‚Ä¢</span>\n                <span>").concat(e.product.reviewCount," reviews</span>\n              </div>\n            </div>\n          </div>\n        "):"",'\n\n        <form>\n          <div class="question-input-container">\n            <label class="input-label">Stel je vraag over dit product</label>\n            <textarea\n              class="question-input"\n              placeholder="Bijvoorbeeld: Hoe stil is dit apparaat?"\n              maxlength="500"\n              rows="3"\n            ></textarea>\n            <div class="char-counter">0/500</div>\n          </div>\n\n          <button type="submit" class="ask-button" ').concat(r?"disabled":"",">\n            ").concat(r?"Even geduld...":"Stel vraag","\n          </button>\n        </form>\n\n        ").concat(r?'\n          <div class="loading">\n            <div class="spinner"></div>\n            <span>AI analyseert reviews...</span>\n          </div>\n        ':"","\n\n        ").concat(e?'\n          <div class="answer-container">\n            <div class="answer-header">\n              <div class="ai-icon">AI</div>\n              <span class="answer-title">Antwoord gebaseerd op '.concat(e.product.reviewCount,' reviews</span>\n              <span class="confidence-badge confidence-').concat(e.confidence,'">').concat(e.confidence,'</span>\n            </div>\n            <div class="answer-text">').concat(e.answer,"</div>\n\n            ").concat(e.relevantReviews&&e.relevantReviews.length>0?'\n              <div class="review-snippets">\n                <div class="snippets-title">Relevante klantreviews</div>\n                '.concat(e.relevantReviews.map(function(n){return'\n                  <div class="review-snippet">\n                    <div class="review-rating">'.concat(t.renderStars(n.rating)," ").concat(n.rating,'/10</div>\n                    <div class="review-text">"').concat(n.excerpt,'"</div>\n                    <div class="review-author">‚Äî ').concat(n.author,"</div>\n                  </div>\n                ")}).join(""),"\n              </div>\n            "):"","\n          </div>\n        "):"","\n\n        ").concat(!e&&!r&&a.length>0?'\n          <div class="popular-questions">\n            <div class="popular-title">üí° Veelgestelde vragen</div>\n            <div class="question-buttons">\n              '.concat(a.map(function(t,n){return'\n                <button type="button" class="question-button" data-question="'.concat(t.question,'" data-index="').concat(n,'">\n                  ').concat(t.question,"\n                </button>\n              ")}).join(""),"\n            </div>\n          </div>\n        "):"","\n      </div>\n    ");var i=this.shadowRoot.querySelector("form");i&&i.addEventListener("submit",function(n){return t.handleSubmit(n)});var c=this.shadowRoot.querySelector(".question-input");c&&c.addEventListener("input",function(n){return t.handleInputChange(n)}),this.shadowRoot.querySelectorAll(".question-button").forEach(function(n,e){n.addEventListener("click",function(){var n,r=null===(n=a[e])||void 0===n?void 0:n.question;r&&t.handlePopularQuestionClick(r)})})}}],o=[{key:"observedAttributes",get:function(){return["data-location-id","data-product-code","data-auto-detect","data-language","data-primary-color","data-show-product-info","data-api-base-url"]}}],r&&E(e.prototype,r),o&&E(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o,a,i,c,u}(_(HTMLElement));customElements.define("kiyoh-ai-widget",R);function D(){}return"loading"===document.readyState?document.addEventListener("DOMContentLoaded",D):D(),t=t.default})());
//# sourceMappingURL=widget.min.js.map